#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Detectando archivos staged..."
STAGED_FILES=$(git diff --name-only --cached)

echo "ğŸ§½ Formateando cÃ³digo..."
npm run format

echo "ğŸ—ï¸ Compilando el proyecto..."
npm run build

echo "â• Reagregando archivos formateados..."
for file in $STAGED_FILES; do
  if [ -f "$file" ]; then
    git add "$file"
  fi
done

CURRENT_BRANCH=$(git rev-parse --abbrev-ref HEAD)

if echo "$CURRENT_BRANCH" | grep -q "^feature/"; then
  echo "ğŸ“¥ Feature branch detectada: $CURRENT_BRANCH"
  git pull origin develop
else
  echo "â„¹ï¸ Rama '$CURRENT_BRANCH' no es una feature, no se hace pull de develop."
fi
